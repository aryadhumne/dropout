<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}EduDrop{% endblock %}</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
{% block head %}{% endblock %}
</head>
<body>

<div style="display:flex;justify-content:space-between;align-items:center;padding:16px 24px;">
  <a href="{{ url_for('select_role') }}" class="auth-back" aria-label="Back to role selection" style="position:static;">
    <i class="bi bi-arrow-left" aria-hidden="true"></i> Back
  </a>
  <div class="lang-switcher">
    <select id="langSelect" onchange="changeLanguage(this.value)" aria-label="Change language">
      <option value="en">English</option>
      <option value="hi">हिन्दी</option>
      <option value="mr">मराठी</option>
    </select>
  </div>
</div>

<main class="auth-wrapper" role="main">
  <div class="auth-card" role="region" aria-label="Authentication form">

    <h1 class="auth-title">{% block form_title %}Welcome{% endblock %}</h1>
    <p class="auth-subtitle">{% block form_subtitle %}{% endblock %}</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ 'danger' if category == 'error' else category }}" role="alert">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block form_content %}{% endblock %}

    {% block form_footer %}{% endblock %}

  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% block scripts %}{% endblock %}

<!-- Google Translate (hidden element) -->
<div id="google_translate_element" style="display:none;"></div>
<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateInit"></script>
<script>
function googleTranslateInit() {
  new google.translate.TranslateElement({pageLanguage: 'en', autoDisplay: false}, 'google_translate_element');
  setTimeout(function() {
    var saved = getCookie('edudrop_lang');
    if (saved && saved !== 'en') triggerTranslate(saved);
    var sel = document.getElementById('langSelect');
    if (sel && saved) sel.value = saved;
  }, 1000);
}
function changeLanguage(lang) {
  setCookie('edudrop_lang', lang, 365);
  if (lang === 'en') {
    setCookie('googtrans', '', -1);
    document.cookie = 'googtrans=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;';
    document.cookie = 'googtrans=; path=/; domain=.' + location.hostname + '; expires=Thu, 01 Jan 1970 00:00:00 UTC;';
    location.reload();
  } else { triggerTranslate(lang); }
}
function triggerTranslate(lang) {
  var combo = document.querySelector('.goog-te-combo');
  if (combo) { combo.value = lang; combo.dispatchEvent(new Event('change')); }
}
function setCookie(n,v,d) { var e=new Date(); e.setTime(e.getTime()+(d*864e5)); document.cookie=n+'='+v+';expires='+e.toUTCString()+';path=/'; }
function getCookie(n) { var m=document.cookie.match(new RegExp('(^| )'+n+'=([^;]+)')); return m?m[2]:null; }
</script>

</body>
</html>
